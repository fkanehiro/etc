#include "LCPcalc.h"
#include <iostream>

using namespace sofa::helper;

int main(int argc, char *argv[])
{

  //#define dim 5  
  //#define dim 15  
#define dim 28
  //#define dim 12  
  double *M[dim];
  for (int i=0; i<dim; i++) M[i] = new double [dim];
  double b[dim], x[dim*2];

#if dim == 5
  M[0][0] = 0.002106;
  M[0][1] = 0.0003775;
  M[0][2] = 0.0002001;
  M[0][3] = -0.0001345;
  M[0][4] = -0.000104;
  M[1][0] = 0.0003775;
  M[1][1] = 0.00134;
  M[1][2] = -3.596e-06;
  M[1][3] = 0.0002055;
  M[1][4] = 0.000436;
  M[2][0] = 0.0002001;
  M[2][1] = -3.596e-06;
  M[2][2] = 0.002444;
  M[2][3] = 0.001029;
  M[2][4] = 0.0006096;
  M[3][0] = -0.0001345;
  M[3][1] = 0.0002055;
  M[3][2] = 0.001029;
  M[3][3] = 0.002476;
  M[3][4] = 0.002334;
  M[4][0] = -0.000104;
  M[4][1] = 0.000436;
  M[4][2] = 0.0006096;
  M[4][3] = 0.002334;
  M[4][4] = 0.002304;
  b[0] = -4.999e-05;
  b[1] = -4.999e-05;
  b[2] = -4.999e-05;
  b[3] = -4.999e-05;
  b[4] = -4.999e-05;
#elif dim == 15
M[0][0] = 0.002106;
M[0][1] = 0.0008371;
M[0][2] = -0.0006314;
M[0][3] = 0.0003775;
M[0][4] = 0.0007092;
M[0][5] = -0.0005357;
M[0][6] = 0.0002001;
M[0][7] = 0.0008764;
M[0][8] = -0.0008072;
M[0][9] = -0.0001345;
M[0][10] = 0.0005884;
M[0][11] = 0.000803;
M[0][12] = -0.000104;
M[0][13] = 0.0005418;
M[0][14] = 0.0007744;
M[1][0] = 0.0008371;
M[1][1] = 0.004861;
M[1][2] = 0.0007742;
M[1][3] = 0.000415;
M[1][4] = 0.002907;
M[1][5] = -0.000315;
M[1][6] = -0.0001143;
M[1][7] = 0.003412;
M[1][8] = -0.000607;
M[1][9] = -0.0006871;
M[1][10] = 0.0004898;
M[1][11] = 0.003166;
M[1][12] = -0.0005963;
M[1][13] = 0.0004397;
M[1][14] = 0.00308;
M[2][0] = -0.0006314;
M[2][1] = 0.0007742;
M[2][2] = 0.005425;
M[2][3] = 0.0002669;
M[2][4] = -0.0007222;
M[2][5] = 0.003839;
M[2][6] = -0.0005135;
M[2][7] = 0.0001437;
M[2][8] = 0.002184;
M[2][9] = 0.0001849;
M[2][10] = -0.002003;
M[2][11] = -0.0006019;
M[2][12] = 0.000319;
M[2][13] = -0.002287;
M[2][14] = -0.0007504;
M[3][0] = 0.0003775;
M[3][1] = 0.000415;
M[3][2] = 0.0002669;
M[3][3] = 0.00134;
M[3][4] = -1.692e-05;
M[3][5] = 0.0005576;
M[3][6] = -3.596e-06;
M[3][7] = 0.0006063;
M[3][8] = 0.0002732;
M[3][9] = 0.0002055;
M[3][10] = -0.000253;
M[3][11] = 0.0001105;
M[3][12] = 0.000436;
M[3][13] = -0.0003017;
M[3][14] = 3.602e-06;
M[4][0] = 0.0007092;
M[4][1] = 0.002907;
M[4][2] = -0.0007222;
M[4][3] = -1.692e-05;
M[4][4] = 0.003865;
M[4][5] = -0.0004742;
M[4][6] = 5.914e-05;
M[4][7] = 0.002547;
M[4][8] = -0.0001988;
M[4][9] = -0.0005505;
M[4][10] = 0.0001333;
M[4][11] = 0.003557;
M[4][12] = -0.0005636;
M[4][13] = 0.0001805;
M[4][14] = 0.003783;
M[5][0] = -0.0005357;
M[5][1] = -0.000315;
M[5][2] = 0.003839;
M[5][3] = 0.0005576;
M[5][4] = -0.0004742;
M[5][5] = 0.004507;
M[5][6] = -0.000101;
M[5][7] = 0.0002717;
M[5][8] = 0.00222;
M[5][9] = 0.0003736;
M[5][10] = -0.002257;
M[5][11] = -0.0004782;
M[5][12] = 0.0004868;
M[5][13] = -0.002649;
M[5][14] = -0.0006061;
M[6][0] = 0.0002001;
M[6][1] = -0.0001143;
M[6][2] = -0.0005135;
M[6][3] = -3.596e-06;
M[6][4] = 5.914e-05;
M[6][5] = -0.000101;
M[6][6] = 0.002444;
M[6][7] = -0.001426;
M[6][8] = -0.0008335;
M[6][9] = 0.001029;
M[6][10] = -7.763e-05;
M[6][11] = -0.0008014;
M[6][12] = 0.0006096;
M[6][13] = -0.0002035;
M[6][14] = -0.0005466;
M[7][0] = 0.0008764;
M[7][1] = 0.003412;
M[7][2] = 0.0001437;
M[7][3] = 0.0006063;
M[7][4] = 0.002547;
M[7][5] = 0.0002717;
M[7][6] = -0.001426;
M[7][7] = 0.005798;
M[7][8] = -0.0002986;
M[7][9] = -0.001452;
M[7][10] = 0.0005978;
M[7][11] = 0.00381;
M[7][12] = -0.001103;
M[7][13] = 0.0005002;
M[7][14] = 0.003252;
M[8][0] = -0.0008072;
M[8][1] = -0.000607;
M[8][2] = 0.002184;
M[8][3] = 0.0002732;
M[8][4] = -0.0001988;
M[8][5] = 0.00222;
M[8][6] = -0.0008335;
M[8][7] = -0.0002986;
M[8][8] = 0.005342;
M[8][9] = 0.0006149;
M[8][10] = -0.003733;
M[8][11] = -0.0006564;
M[8][12] = 0.0008045;
M[8][13] = -0.003197;
M[8][14] = -0.0006392;
M[9][0] = -0.0001345;
M[9][1] = -0.0006871;
M[9][2] = 0.0001849;
M[9][3] = 0.0002055;
M[9][4] = -0.0005505;
M[9][5] = 0.0003736;
M[9][6] = 0.001029;
M[9][7] = -0.001452;
M[9][8] = 0.0006149;
M[9][9] = 0.002476;
M[9][10] = -0.0003308;
M[9][11] = -0.001865;
M[9][12] = 0.002334;
M[9][13] = -0.0002894;
M[9][14] = -0.001711;
M[10][0] = 0.0005884;
M[10][1] = 0.0004898;
M[10][2] = -0.002003;
M[10][3] = -0.000253;
M[10][4] = 0.0001333;
M[10][5] = -0.002257;
M[10][6] = -7.763e-05;
M[10][7] = 0.0005978;
M[10][8] = -0.003733;
M[10][9] = -0.0003308;
M[10][10] = 0.004619;
M[10][11] = -5.544e-05;
M[10][12] = -0.0003607;
M[10][13] = 0.004365;
M[10][14] = -0.0001351;
M[11][0] = 0.000803;
M[11][1] = 0.003166;
M[11][2] = -0.0006019;
M[11][3] = 0.0001105;
M[11][4] = 0.003557;
M[11][5] = -0.0004782;
M[11][6] = -0.0008014;
M[11][7] = 0.00381;
M[11][8] = -0.0006564;
M[11][9] = -0.001865;
M[11][10] = -5.544e-05;
M[11][11] = 0.005285;
M[11][12] = -0.001709;
M[11][13] = -8.591e-05;
M[11][14] = 0.005241;
M[12][0] = -0.000104;
M[12][1] = -0.0005963;
M[12][2] = 0.000319;
M[12][3] = 0.000436;
M[12][4] = -0.0005636;
M[12][5] = 0.0004868;
M[12][6] = 0.0006096;
M[12][7] = -0.001103;
M[12][8] = 0.0008045;
M[12][9] = 0.002334;
M[12][10] = -0.0003607;
M[12][11] = -0.001709;
M[12][12] = 0.002304;
M[12][13] = -0.0003062;
M[12][14] = -0.001616;
M[13][0] = 0.0005418;
M[13][1] = 0.0004397;
M[13][2] = -0.002287;
M[13][3] = -0.0003017;
M[13][4] = 0.0001805;
M[13][5] = -0.002649;
M[13][6] = -0.0002035;
M[13][7] = 0.0005002;
M[13][8] = -0.003197;
M[13][9] = -0.0002894;
M[13][10] = 0.004365;
M[13][11] = -8.591e-05;
M[13][12] = -0.0003062;
M[13][13] = 0.004272;
M[13][14] = -0.0001407;
M[14][0] = 0.0007744;
M[14][1] = 0.00308;
M[14][2] = -0.0007504;
M[14][3] = 3.602e-06;
M[14][4] = 0.003783;
M[14][5] = -0.0006061;
M[14][6] = -0.0005466;
M[14][7] = 0.003252;
M[14][8] = -0.0006392;
M[14][9] = -0.001711;
M[14][10] = -0.0001351;
M[14][11] = 0.005241;
M[14][12] = -0.001616;
M[14][13] = -0.0001407;
M[14][14] = 0.005332;

  b[ 0] = -4.999e-05;
  b[ 1] = 0;
  b[ 2] = 0;
  b[ 3] = -4.999e-05;
  b[ 4] = 0;
  b[ 5] = 0;
  b[ 6] = -4.999e-05;
  b[ 7] = 0;
  b[ 8] = 0;
  b[ 9] = -4.999e-05;
  b[10] = 0;
  b[11] = 0;
  b[12] = -4.999e-05;
  b[13] = 0;
  b[14] = 0;
#elif dim == 12
M[0][0] = 0.002106;
M[0][1] = 0.0008371;
M[0][2] = -0.0006314;
M[0][3] = 0.0003775;
M[0][4] = 0.0007092;
M[0][5] = -0.0005357;
M[0][6] = 0.0002001;
M[0][7] = 0.0008764;
M[0][8] = -0.0008072;
M[0][9] = -0.0002034;
M[0][10] = 0.0007879;
M[0][11] = -0.0005431;
M[1][0] = 0.0008371;
M[1][1] = 0.004861;
M[1][2] = 0.0007742;
M[1][3] = 0.000415;
M[1][4] = 0.002907;
M[1][5] = -0.000315;
M[1][6] = -0.0001143;
M[1][7] = 0.003412;
M[1][8] = -0.000607;
M[1][9] = -0.0008054;
M[1][10] = 0.003115;
M[1][11] = -0.000466;
M[2][0] = -0.0006314;
M[2][1] = 0.0007742;
M[2][2] = 0.005425;
M[2][3] = 0.0002669;
M[2][4] = -0.0007222;
M[2][5] = 0.003839;
M[2][6] = -0.0005135;
M[2][7] = 0.0001437;
M[2][8] = 0.002184;
M[2][9] = 0.0003281;
M[2][10] = -0.0007563;
M[2][11] = 0.001966;
M[3][0] = 0.0003775;
M[3][1] = 0.000415;
M[3][2] = 0.0002669;
M[3][3] = 0.00134;
M[3][4] = -1.692e-05;
M[3][5] = 0.0005576;
M[3][6] = -3.596e-06;
M[3][7] = 0.0006063;
M[3][8] = 0.0002732;
M[3][9] = 0.0002486;
M[3][10] = 7.847e-06;
M[3][11] = 0.000249;
M[4][0] = 0.0007092;
M[4][1] = 0.002907;
M[4][2] = -0.0007222;
M[4][3] = -1.692e-05;
M[4][4] = 0.003865;
M[4][5] = -0.0004742;
M[4][6] = 5.914e-05;
M[4][7] = 0.002547;
M[4][8] = -0.0001988;
M[4][9] = -0.0006767;
M[4][10] = 0.003766;
M[4][11] = -0.0001201;
M[5][0] = -0.0005357;
M[5][1] = -0.000315;
M[5][2] = 0.003839;
M[5][3] = 0.0005576;
M[5][4] = -0.0004742;
M[5][5] = 0.004507;
M[5][6] = -0.000101;
M[5][7] = 0.0002717;
M[5][8] = 0.00222;
M[5][9] = 0.0004703;
M[5][10] = -0.0006334;
M[5][11] = 0.002265;
M[6][0] = 0.0002001;
M[6][1] = -0.0001143;
M[6][2] = -0.0005135;
M[6][3] = -3.596e-06;
M[6][4] = 5.914e-05;
M[6][5] = -0.000101;
M[6][6] = 0.002444;
M[6][7] = -0.001426;
M[6][8] = -0.0008335;
M[6][9] = 0.0007364;
M[6][10] = -0.000672;
M[6][11] = 0.000267;
M[7][0] = 0.0008764;
M[7][1] = 0.003412;
M[7][2] = 0.0001437;
M[7][3] = 0.0006063;
M[7][4] = 0.002547;
M[7][5] = 0.0002717;
M[7][6] = -0.001426;
M[7][7] = 0.005798;
M[7][8] = -0.0002986;
M[7][9] = -0.001457;
M[7][10] = 0.003398;
M[7][11] = -0.0006608;
M[8][0] = -0.0008072;
M[8][1] = -0.000607;
M[8][2] = 0.002184;
M[8][3] = 0.0002732;
M[8][4] = -0.0001988;
M[8][5] = 0.00222;
M[8][6] = -0.0008335;
M[8][7] = -0.0002986;
M[8][8] = 0.005342;
M[8][9] = 0.0009122;
M[8][10] = -0.0007304;
M[8][11] = 0.0034;
M[9][0] = -0.0002034;
M[9][1] = -0.0008054;
M[9][2] = 0.0003281;
M[9][3] = 0.0002486;
M[9][4] = -0.0006767;
M[9][5] = 0.0004703;
M[9][6] = 0.0007364;
M[9][7] = -0.001457;
M[9][8] = 0.0009122;
M[9][9] = 0.003197;
M[9][10] = -0.002216;
M[9][11] = 0.0002716;
M[10][0] = 0.0007879;
M[10][1] = 0.003115;
M[10][2] = -0.0007563;
M[10][3] = 7.847e-06;
M[10][4] = 0.003766;
M[10][5] = -0.0006334;
M[10][6] = -0.000672;
M[10][7] = 0.003398;
M[10][8] = -0.0007304;
M[10][9] = -0.002216;
M[10][10] = 0.006044;
M[10][11] = 0.00038;
M[11][0] = -0.0005431;
M[11][1] = -0.000466;
M[11][2] = 0.001966;
M[11][3] = 0.000249;
M[11][4] = -0.0001201;
M[11][5] = 0.002265;
M[11][6] = 0.000267;
M[11][7] = -0.0006608;
M[11][8] = 0.0034;
M[11][9] = 0.0002716;
M[11][10] = 0.00038;
M[11][11] = 0.005093;

  b[ 0] = -4.999e-05;
  b[ 1] = 0;
  b[ 2] = 0;
  b[ 3] = -4.999e-05;
  b[ 4] = 0;
  b[ 5] = 0;
  b[ 6] = -4.999e-05;
  b[ 7] = 0;
  b[ 8] = 0;
  b[ 9] = -4.999e-05;
  b[10] = 0;
  b[11] = 0;
#elif dim == 28
M[0][0] = 0.01198;
M[0][1] = 0.004934;
M[0][2] = 0.004766;
M[0][3] = 0.01173;
M[0][4] = 0.001586;
M[0][5] = 0.00263;
M[0][6] = 0.001097;
M[0][7] = 0.00113;
M[0][8] = 0.0001606;
M[0][9] = 0.0004513;
M[0][10] = 3.029e-05;
M[0][11] = 0.0001536;
M[0][12] = -0.0004318;
M[0][13] = -0.0008521;
M[0][14] = -0.000413;
M[0][15] = -0.0008817;
M[0][16] = -0.001496;
M[0][17] = -0.00108;
M[0][18] = -0.001077;
M[0][19] = 0.004603;
M[0][20] = 0.007852;
M[0][21] = 0.001065;
M[0][22] = 0.0006609;
M[0][23] = -9.482e-05;
M[0][24] = -0.0004709;
M[0][25] = 0.0001321;
M[0][26] = -0.0009126;
M[0][27] = -0.001515;
M[1][0] = 0.004934;
M[1][1] = 0.00719;
M[1][2] = 0.004104;
M[1][3] = 0.004808;
M[1][4] = 0.002443;
M[1][5] = 0.001982;
M[1][6] = 0.001827;
M[1][7] = 0.001624;
M[1][8] = 0.0005639;
M[1][9] = 0.0006916;
M[1][10] = 0.0002984;
M[1][11] = 0.0009757;
M[1][12] = 0.0002788;
M[1][13] = -0.0003342;
M[1][14] = -0.0001156;
M[1][15] = -0.0004995;
M[1][16] = -0.0009734;
M[1][17] = -0.00115;
M[1][18] = -0.001148;
M[1][19] = 0.001111;
M[1][20] = 0.004527;
M[1][21] = 0.0001237;
M[1][22] = 0.0007851;
M[1][23] = 4.541e-05;
M[1][24] = -0.0005718;
M[1][25] = -0.0006097;
M[1][26] = -0.0006718;
M[1][27] = -0.0009903;
M[2][0] = 0.004766;
M[2][1] = 0.004104;
M[2][2] = 0.004098;
M[2][3] = 0.004744;
M[2][4] = 0.001636;
M[2][5] = 0.002486;
M[2][6] = 0.0009896;
M[2][7] = 0.001324;
M[2][8] = 0.0003393;
M[2][9] = 0.000726;
M[2][10] = 0.000244;
M[2][11] = 0.0002309;
M[2][12] = -0.0001312;
M[2][13] = -0.0004947;
M[2][14] = -0.0001194;
M[2][15] = -0.0004875;
M[2][16] = -0.0009337;
M[2][17] = -0.0006627;
M[2][18] = -0.0006604;
M[2][19] = 0.004091;
M[2][20] = 0.003388;
M[2][21] = 0.001069;
M[2][22] = 0.001004;
M[2][23] = 0.0001523;
M[2][24] = -0.0001226;
M[2][25] = 0.0003297;
M[2][26] = -0.0004797;
M[2][27] = -0.0009464;
M[3][0] = 0.01173;
M[3][1] = 0.004808;
M[3][2] = 0.004744;
M[3][3] = 0.0115;
M[3][4] = 0.001562;
M[3][5] = 0.002642;
M[3][6] = 0.001066;
M[3][7] = 0.001127;
M[3][8] = 0.0001593;
M[3][9] = 0.0004615;
M[3][10] = 3.559e-05;
M[3][11] = 0.0001324;
M[3][12] = -0.000435;
M[3][13] = -0.0008455;
M[3][14] = -0.0004034;
M[3][15] = -0.0008684;
M[3][16] = -0.001476;
M[3][17] = -0.001051;
M[3][18] = -0.001048;
M[3][19] = 0.004681;
M[3][20] = 0.007669;
M[3][21] = 0.001096;
M[3][22] = 0.0006792;
M[3][23] = -8.326e-05;
M[3][24] = -0.000445;
M[3][25] = 0.0001686;
M[3][26] = -0.0008922;
M[3][27] = -0.001494;
M[4][0] = 0.001586;
M[4][1] = 0.002443;
M[4][2] = 0.001636;
M[4][3] = 0.001562;
M[4][4] = 0.003617;
M[4][5] = 0.00266;
M[4][6] = 0.001497;
M[4][7] = 0.002429;
M[4][8] = 0.0007934;
M[4][9] = 0.001035;
M[4][10] = 0.000571;
M[4][11] = 0.0007499;
M[4][12] = 0.0004587;
M[4][13] = -5.204e-05;
M[4][14] = 0.0001852;
M[4][15] = -0.000115;
M[4][16] = -0.0004521;
M[4][17] = -0.0005103;
M[4][18] = -0.0005095;
M[4][19] = 0.0008529;
M[4][20] = 0.001471;
M[4][21] = 0.0004332;
M[4][22] = 0.00121;
M[4][23] = 0.0003581;
M[4][24] = -7.697e-05;
M[4][25] = -9.082e-05;
M[4][26] = -0.0001805;
M[4][27] = -0.000463;
M[5][0] = 0.00263;
M[5][1] = 0.001982;
M[5][2] = 0.002486;
M[5][3] = 0.002642;
M[5][4] = 0.00266;
M[5][5] = 0.002769;
M[5][6] = 0.00104;
M[5][7] = 0.001946;
M[5][8] = 0.0005607;
M[5][9] = 0.0009396;
M[5][10] = 0.0004396;
M[5][11] = 0.0003199;
M[5][12] = 0.0001167;
M[5][13] = -0.0002592;
M[5][14] = 7.853e-05;
M[5][15] = -0.0002399;
M[5][16] = -0.0006054;
M[5][17] = -0.0003994;
M[5][18] = -0.0003978;
M[5][19] = 0.002974;
M[5][20] = 0.00175;
M[5][21] = 0.000971;
M[5][22] = 0.001212;
M[5][23] = 0.0003229;
M[5][24] = 5.833e-05;
M[5][25] = 0.0003706;
M[5][26] = -0.0002194;
M[5][27] = -0.0006156;
M[6][0] = 0.001097;
M[6][1] = 0.001827;
M[6][2] = 0.0009896;
M[6][3] = 0.001066;
M[6][4] = 0.001497;
M[6][5] = 0.00104;
M[6][6] = 0.006778;
M[6][7] = 0.0009654;
M[6][8] = 0.0008734;
M[6][9] = 0.0006102;
M[6][10] = 0.0003986;
M[6][11] = 0.003645;
M[6][12] = 0.001142;
M[6][13] = 0.0001645;
M[6][14] = 3.477e-05;
M[6][15] = -0.0002428;
M[6][16] = -0.0006745;
M[6][17] = -0.001614;
M[6][18] = -0.001615;
M[6][19] = 0.0001777;
M[6][20] = 0.001895;
M[6][21] = -0.0002881;
M[6][22] = 0.0004233;
M[6][23] = -5.313e-05;
M[6][24] = -0.000713;
M[6][25] = -0.001003;
M[6][26] = -0.0006681;
M[6][27] = -0.0006948;
M[7][0] = 0.00113;
M[7][1] = 0.001624;
M[7][2] = 0.001324;
M[7][3] = 0.001127;
M[7][4] = 0.002429;
M[7][5] = 0.001946;
M[7][6] = 0.0009654;
M[7][7] = 0.002262;
M[7][8] = 0.0006714;
M[7][9] = 0.001497;
M[7][10] = 0.0006614;
M[7][11] = 0.0003435;
M[7][12] = 0.0002448;
M[7][13] = -5.863e-05;
M[7][14] = 0.0003535;
M[7][15] = 1.413e-05;
M[7][16] = -0.0002879;
M[7][17] = -0.0001761;
M[7][18] = -0.0001746;
M[7][19] = 0.001033;
M[7][20] = 0.0008292;
M[7][21] = 0.001036;
M[7][22] = 0.002091;
M[7][23] = 0.0006517;
M[7][24] = 0.0003121;
M[7][25] = 0.0004373;
M[7][26] = 9.126e-05;
M[7][27] = -0.0002947;
M[8][0] = 0.0001606;
M[8][1] = 0.0005639;
M[8][2] = 0.0003393;
M[8][3] = 0.0001593;
M[8][4] = 0.0007934;
M[8][5] = 0.0005607;
M[8][6] = 0.0008734;
M[8][7] = 0.0006714;
M[8][8] = 0.002654;
M[8][9] = 0.001429;
M[8][10] = 0.001698;
M[8][11] = 0.0009964;
M[8][12] = 0.001661;
M[8][13] = 0.001069;
M[8][14] = 0.0009002;
M[8][15] = 0.0007527;
M[8][16] = 0.0005982;
M[8][17] = 1.643e-05;
M[8][18] = 1.545e-05;
M[8][19] = 0.0001216;
M[8][20] = 0.0004458;
M[8][21] = 2.744e-05;
M[8][22] = 0.0005471;
M[8][23] = 0.0007795;
M[8][24] = 0.0002217;
M[8][25] = -0.0001392;
M[8][26] = 0.0004187;
M[8][27] = 0.0005858;
M[9][0] = 0.0004513;
M[9][1] = 0.0006916;
M[9][2] = 0.000726;
M[9][3] = 0.0004615;
M[9][4] = 0.001035;
M[9][5] = 0.0009396;
M[9][6] = 0.0006102;
M[9][7] = 0.001497;
M[9][8] = 0.001429;
M[9][9] = 0.001744;
M[9][10] = 0.001149;
M[9][11] = 0.0003748;
M[9][12] = 0.0007102;
M[9][13] = 0.0004098;
M[9][14] = 0.0006829;
M[9][15] = 0.0004004;
M[9][16] = 0.000181;
M[9][17] = 0.0001036;
M[9][18] = 0.0001045;
M[9][19] = 0.0007593;
M[9][20] = 0.0002868;
M[9][21] = 0.0009737;
M[9][22] = 0.001971;
M[9][23] = 0.0008803;
M[9][24] = 0.0005062;
M[9][25] = 0.0005107;
M[9][26] = 0.0003904;
M[9][27] = 0.0001744;
M[10][0] = 3.029e-05;
M[10][1] = 0.0002984;
M[10][2] = 0.000244;
M[10][3] = 3.559e-05;
M[10][4] = 0.000571;
M[10][5] = 0.0004396;
M[10][6] = 0.0003986;
M[10][7] = 0.0006614;
M[10][8] = 0.001698;
M[10][9] = 0.001149;
M[10][10] = 0.00176;
M[10][11] = 0.0003913;
M[10][12] = 0.0009426;
M[10][13] = 0.000833;
M[10][14] = 0.001405;
M[10][15] = 0.0009093;
M[10][16] = 0.0008001;
M[10][17] = 0.0005453;
M[10][18] = 0.0005453;
M[10][19] = 0.0001912;
M[10][20] = 3.329e-05;
M[10][21] = 0.0002758;
M[10][22] = 0.0007542;
M[10][23] = 0.001818;
M[10][24] = 0.0009699;
M[10][25] = 0.0003986;
M[10][26] = 0.0009903;
M[10][27] = 0.0007991;
M[11][0] = 0.0001536;
M[11][1] = 0.0009757;
M[11][2] = 0.0002309;
M[11][3] = 0.0001324;
M[11][4] = 0.0007499;
M[11][5] = 0.0003199;
M[11][6] = 0.003645;
M[11][7] = 0.0003435;
M[11][8] = 0.0009964;
M[11][9] = 0.0003748;
M[11][10] = 0.0003913;
M[11][11] = 0.01737;
M[11][12] = 0.003296;
M[11][13] = 0.001211;
M[11][14] = 0.0003968;
M[11][15] = 0.0003652;
M[11][16] = 0.0001976;
M[11][17] = -0.001621;
M[11][18] = -0.001623;
M[11][19] = -0.0004905;
M[11][20] = 0.001675;
M[11][21] = -0.0008332;
M[11][22] = -6.906e-05;
M[11][23] = -0.000183;
M[11][24] = -0.000883;
M[11][25] = -0.001487;
M[11][26] = -0.0005217;
M[11][27] = 0.0001743;
M[12][0] = -0.0004318;
M[12][1] = 0.0002788;
M[12][2] = -0.0001312;
M[12][3] = -0.000435;
M[12][4] = 0.0004587;
M[12][5] = 0.0001167;
M[12][6] = 0.001142;
M[12][7] = 0.0002448;
M[12][8] = 0.001661;
M[12][9] = 0.0007102;
M[12][10] = 0.0009426;
M[12][11] = 0.003296;
M[12][12] = 0.006117;
M[12][13] = 0.002092;
M[12][14] = 0.001023;
M[12][15] = 0.001172;
M[12][16] = 0.00123;
M[12][17] = -0.0003646;
M[12][18] = -0.000366;
M[12][19] = -0.0005282;
M[12][20] = 0.0006945;
M[12][21] = -0.0006765;
M[12][22] = 2.807e-05;
M[12][23] = 0.0002571;
M[12][24] = -0.0003574;
M[12][25] = -0.001064;
M[12][26] = 0.0002022;
M[12][27] = 0.001209;
M[13][0] = -0.0008521;
M[13][1] = -0.0003342;
M[13][2] = -0.0004947;
M[13][3] = -0.0008455;
M[13][4] = -5.204e-05;
M[13][5] = -0.0002592;
M[13][6] = 0.0001645;
M[13][7] = -5.863e-05;
M[13][8] = 0.001069;
M[13][9] = 0.0004098;
M[13][10] = 0.000833;
M[13][11] = 0.001211;
M[13][12] = 0.002092;
M[13][13] = 0.005462;
M[13][14] = 0.002644;
M[13][15] = 0.003574;
M[13][16] = 0.004154;
M[13][17] = 0.002079;
M[13][18] = 0.00208;
M[13][19] = -0.00065;
M[13][20] = -0.0001638;
M[13][21] = -0.0005415;
M[13][22] = -6.397e-05;
M[13][23] = 0.0006083;
M[13][24] = 0.0002433;
M[13][25] = -0.0004891;
M[13][26] = 0.001572;
M[13][27] = 0.004118;
M[14][0] = -0.000413;
M[14][1] = -0.0001156;
M[14][2] = -0.0001194;
M[14][3] = -0.0004034;
M[14][4] = 0.0001852;
M[14][5] = 7.853e-05;
M[14][6] = 3.477e-05;
M[14][7] = 0.0003535;
M[14][8] = 0.0009002;
M[14][9] = 0.0006829;
M[14][10] = 0.001405;
M[14][11] = 0.0003968;
M[14][12] = 0.001023;
M[14][13] = 0.002644;
M[14][14] = 0.002207;
M[14][15] = 0.002116;
M[14][16] = 0.002321;
M[14][17] = 0.001489;
M[14][18] = 0.00149;
M[14][19] = -0.000123;
M[14][20] = -0.0002793;
M[14][21] = 7.169e-05;
M[14][22] = 0.0005265;
M[14][23] = 0.00189;
M[14][24] = 0.001083;
M[14][25] = 0.0003267;
M[14][26] = 0.001554;
M[14][27] = 0.002311;
M[15][0] = -0.0008817;
M[15][1] = -0.0004995;
M[15][2] = -0.0004875;
M[15][3] = -0.0008684;
M[15][4] = -0.000115;
M[15][5] = -0.0002399;
M[15][6] = -0.0002428;
M[15][7] = 1.413e-05;
M[15][8] = 0.0007527;
M[15][9] = 0.0004004;
M[15][10] = 0.0009093;
M[15][11] = 0.0003652;
M[15][12] = 0.001172;
M[15][13] = 0.003574;
M[15][14] = 0.002116;
M[15][15] = 0.003829;
M[15][16] = 0.003762;
M[15][17] = 0.00281;
M[15][18] = 0.00281;
M[15][19] = -0.0004759;
M[15][20] = -0.0006085;
M[15][21] = -0.0001628;
M[15][22] = 0.0001467;
M[15][23] = 0.00106;
M[15][24] = 0.001094;
M[15][25] = 0.0003133;
M[15][26] = 0.004098;
M[15][27] = 0.003767;
M[16][0] = -0.001496;
M[16][1] = -0.0009734;
M[16][2] = -0.0009337;
M[16][3] = -0.001476;
M[16][4] = -0.0004521;
M[16][5] = -0.0006054;
M[16][6] = -0.0006745;
M[16][7] = -0.0002879;
M[16][8] = 0.0005982;
M[16][9] = 0.000181;
M[16][10] = 0.0008001;
M[16][11] = 0.0001976;
M[16][12] = 0.00123;
M[16][13] = 0.004154;
M[16][14] = 0.002321;
M[16][15] = 0.003762;
M[16][16] = 0.01403;
M[16][17] = 0.01003;
M[16][18] = 0.01002;
M[16][19] = -0.0008951;
M[16][20] = -0.001002;
M[16][21] = -0.0004813;
M[16][22] = -0.0001193;
M[16][23] = 0.0009945;
M[16][24] = 0.0009875;
M[16][25] = 6.359e-05;
M[16][26] = 0.003346;
M[16][27] = 0.01431;
M[17][0] = -0.00108;
M[17][1] = -0.00115;
M[17][2] = -0.0006627;
M[17][3] = -0.001051;
M[17][4] = -0.0005103;
M[17][5] = -0.0003994;
M[17][6] = -0.001614;
M[17][7] = -0.0001761;
M[17][8] = 1.643e-05;
M[17][9] = 0.0001036;
M[17][10] = 0.0005453;
M[17][11] = -0.001621;
M[17][12] = -0.0003646;
M[17][13] = 0.002079;
M[17][14] = 0.001489;
M[17][15] = 0.00281;
M[17][16] = 0.01003;
M[17][17] = 0.02089;
M[17][18] = 0.0209;
M[17][19] = -0.0001908;
M[17][20] = -0.0007735;
M[17][21] = 0.0005793;
M[17][22] = 0.000163;
M[17][23] = 0.001043;
M[17][24] = 0.001648;
M[17][25] = 0.001533;
M[17][26] = 0.003552;
M[17][27] = 0.01021;
M[18][0] = -0.001077;
M[18][1] = -0.001148;
M[18][2] = -0.0006604;
M[18][3] = -0.001048;
M[18][4] = -0.0005095;
M[18][5] = -0.0003978;
M[18][6] = -0.001615;
M[18][7] = -0.0001746;
M[18][8] = 1.545e-05;
M[18][9] = 0.0001045;
M[18][10] = 0.0005453;
M[18][11] = -0.001623;
M[18][12] = -0.000366;
M[18][13] = 0.00208;
M[18][14] = 0.00149;
M[18][15] = 0.00281;
M[18][16] = 0.01002;
M[18][17] = 0.0209;
M[18][18] = 0.02092;
M[18][19] = -0.0001875;
M[18][20] = -0.0007774;
M[18][21] = 0.0005835;
M[18][22] = 0.0001651;
M[18][23] = 0.001044;
M[18][24] = 0.001651;
M[18][25] = 0.001538;
M[18][26] = 0.003551;
M[18][27] = 0.0102;
M[19][0] = 0.004603;
M[19][1] = 0.001111;
M[19][2] = 0.004091;
M[19][3] = 0.004681;
M[19][4] = 0.0008529;
M[19][5] = 0.002974;
M[19][6] = 0.0001777;
M[19][7] = 0.001033;
M[19][8] = 0.0001216;
M[19][9] = 0.0007593;
M[19][10] = 0.0001912;
M[19][11] = -0.0004905;
M[19][12] = -0.0005282;
M[19][13] = -0.00065;
M[19][14] = -0.000123;
M[19][15] = -0.0004759;
M[19][16] = -0.0008951;
M[19][17] = -0.0001908;
M[19][18] = -0.0001875;
M[19][19] = 0.006981;
M[19][20] = 0.002286;
M[19][21] = 0.001985;
M[19][22] = 0.001217;
M[19][23] = 0.0002558;
M[19][24] = 0.0003123;
M[19][25] = 0.00124;
M[19][26] = -0.0002937;
M[19][27] = -0.0009037;
M[20][0] = 0.007852;
M[20][1] = 0.004527;
M[20][2] = 0.003388;
M[20][3] = 0.007669;
M[20][4] = 0.001471;
M[20][5] = 0.00175;
M[20][6] = 0.001895;
M[20][7] = 0.0008292;
M[20][8] = 0.0004458;
M[20][9] = 0.0002868;
M[20][10] = 3.329e-05;
M[20][11] = 0.001675;
M[20][12] = 0.0006945;
M[20][13] = -0.0001638;
M[20][14] = -0.0002793;
M[20][15] = -0.0006085;
M[20][16] = -0.001002;
M[20][17] = -0.0007735;
M[20][18] = -0.0007774;
M[20][19] = 0.002286;
M[20][20] = 0.01482;
M[20][21] = -0.0003615;
M[20][22] = 0.0001778;
M[20][23] = -0.0003568;
M[20][24] = -0.001295;
M[20][25] = -0.001499;
M[20][26] = -0.001076;
M[20][27] = -0.001026;
M[21][0] = 0.001065;
M[21][1] = 0.0001237;
M[21][2] = 0.001069;
M[21][3] = 0.001096;
M[21][4] = 0.0004332;
M[21][5] = 0.000971;
M[21][6] = -0.0002881;
M[21][7] = 0.001036;
M[21][8] = 2.744e-05;
M[21][9] = 0.0009737;
M[21][10] = 0.0002758;
M[21][11] = -0.0008332;
M[21][12] = -0.0006765;
M[21][13] = -0.0005415;
M[21][14] = 7.169e-05;
M[21][15] = -0.0001628;
M[21][16] = -0.0004813;
M[21][17] = 0.0005793;
M[21][18] = 0.0005835;
M[21][19] = 0.001985;
M[21][20] = -0.0003615;
M[21][21] = 0.006206;
M[21][22] = 0.001652;
M[21][23] = 0.00051;
M[21][24] = 0.001275;
M[21][25] = 0.003701;
M[21][26] = 0.0002334;
M[21][27] = -0.0004828;
M[22][0] = 0.0006609;
M[22][1] = 0.0007851;
M[22][2] = 0.001004;
M[22][3] = 0.0006792;
M[22][4] = 0.00121;
M[22][5] = 0.001212;
M[22][6] = 0.0004233;
M[22][7] = 0.002091;
M[22][8] = 0.0005471;
M[22][9] = 0.001971;
M[22][10] = 0.0007542;
M[22][11] = -6.906e-05;
M[22][12] = 2.807e-05;
M[22][13] = -6.397e-05;
M[22][14] = 0.0005265;
M[22][15] = 0.0001467;
M[22][16] = -0.0001193;
M[22][17] = 0.000163;
M[22][18] = 0.0001651;
M[22][19] = 0.001217;
M[22][20] = 0.0001778;
M[22][21] = 0.001652;
M[22][22] = 0.002995;
M[22][23] = 0.0009522;
M[22][24] = 0.0007084;
M[22][25] = 0.0009742;
M[22][26] = 0.0003687;
M[22][27] = -0.0001218;
M[23][0] = -9.482e-05;
M[23][1] = 4.541e-05;
M[23][2] = 0.0001523;
M[23][3] = -8.326e-05;
M[23][4] = 0.0003581;
M[23][5] = 0.0003229;
M[23][6] = -5.313e-05;
M[23][7] = 0.0006517;
M[23][8] = 0.0007795;
M[23][9] = 0.0008803;
M[23][10] = 0.001818;
M[23][11] = -0.000183;
M[23][12] = 0.0002571;
M[23][13] = 0.0006083;
M[23][14] = 0.00189;
M[23][15] = 0.00106;
M[23][16] = 0.0009945;
M[23][17] = 0.001043;
M[23][18] = 0.001044;
M[23][19] = 0.0002558;
M[23][20] = -0.0003568;
M[23][21] = 0.00051;
M[23][22] = 0.0009522;
M[23][23] = 0.002816;
M[23][24] = 0.001684;
M[23][25] = 0.000907;
M[23][26] = 0.001537;
M[23][27] = 0.001004;
M[24][0] = -0.0004709;
M[24][1] = -0.0005718;
M[24][2] = -0.0001226;
M[24][3] = -0.000445;
M[24][4] = -7.697e-05;
M[24][5] = 5.833e-05;
M[24][6] = -0.000713;
M[24][7] = 0.0003121;
M[24][8] = 0.0002217;
M[24][9] = 0.0005062;
M[24][10] = 0.0009699;
M[24][11] = -0.000883;
M[24][12] = -0.0003574;
M[24][13] = 0.0002433;
M[24][14] = 0.001083;
M[24][15] = 0.001094;
M[24][16] = 0.0009875;
M[24][17] = 0.001648;
M[24][18] = 0.001651;
M[24][19] = 0.0003123;
M[24][20] = -0.001295;
M[24][21] = 0.001275;
M[24][22] = 0.0007084;
M[24][23] = 0.001684;
M[24][24] = 0.00644;
M[24][25] = 0.004895;
M[24][26] = 0.00199;
M[24][27] = 0.001006;
M[25][0] = 0.0001321;
M[25][1] = -0.0006097;
M[25][2] = 0.0003297;
M[25][3] = 0.0001686;
M[25][4] = -9.082e-05;
M[25][5] = 0.0003706;
M[25][6] = -0.001003;
M[25][7] = 0.0004373;
M[25][8] = -0.0001392;
M[25][9] = 0.0005107;
M[25][10] = 0.0003986;
M[25][11] = -0.001487;
M[25][12] = -0.001064;
M[25][13] = -0.0004891;
M[25][14] = 0.0003267;
M[25][15] = 0.0003133;
M[25][16] = 6.359e-05;
M[25][17] = 0.001533;
M[25][18] = 0.001538;
M[25][19] = 0.00124;
M[25][20] = -0.001499;
M[25][21] = 0.003701;
M[25][22] = 0.0009742;
M[25][23] = 0.000907;
M[25][24] = 0.004895;
M[25][25] = 0.01365;
M[25][26] = 0.001155;
M[25][27] = 7.437e-05;
M[26][0] = -0.0009126;
M[26][1] = -0.0006718;
M[26][2] = -0.0004797;
M[26][3] = -0.0008922;
M[26][4] = -0.0001805;
M[26][5] = -0.0002194;
M[26][6] = -0.0006681;
M[26][7] = 9.126e-05;
M[26][8] = 0.0004187;
M[26][9] = 0.0003904;
M[26][10] = 0.0009903;
M[26][11] = -0.0005217;
M[26][12] = 0.0002022;
M[26][13] = 0.001572;
M[26][14] = 0.001554;
M[26][15] = 0.004098;
M[26][16] = 0.003346;
M[26][17] = 0.003552;
M[26][18] = 0.003551;
M[26][19] = -0.0002937;
M[26][20] = -0.001076;
M[26][21] = 0.0002334;
M[26][22] = 0.0003687;
M[26][23] = 0.001537;
M[26][24] = 0.00199;
M[26][25] = 0.001155;
M[26][26] = 0.006777;
M[26][27] = 0.003393;
M[27][0] = -0.001515;
M[27][1] = -0.0009903;
M[27][2] = -0.0009464;
M[27][3] = -0.001494;
M[27][4] = -0.000463;
M[27][5] = -0.0006156;
M[27][6] = -0.0006948;
M[27][7] = -0.0002947;
M[27][8] = 0.0005858;
M[27][9] = 0.0001744;
M[27][10] = 0.0007991;
M[27][11] = 0.0001743;
M[27][12] = 0.001209;
M[27][13] = 0.004118;
M[27][14] = 0.002311;
M[27][15] = 0.003767;
M[27][16] = 0.01431;
M[27][17] = 0.01021;
M[27][18] = 0.0102;
M[27][19] = -0.0009037;
M[27][20] = -0.001026;
M[27][21] = -0.0004828;
M[27][22] = -0.0001218;
M[27][23] = 0.001004;
M[27][24] = 0.001006;
M[27][25] = 7.437e-05;
M[27][26] = 0.003393;
M[27][27] = 0.01461;
 b[0] = -0.00334;
 b[1] = -0.002223;
 b[2] = -0.003278;
 b[3] = -0.003371;
 b[4] = -0.002644;
 b[5] = -0.003218;
 b[6] = -0.001076;
 b[7] = -0.003165;
 b[8] = -0.002284;
 b[9] = -0.003107;
 b[10] = -0.003037;
 b[11] = 9.414e-05;
 b[12] = -0.0008917;
 b[13] = -0.001857;
 b[14] = -0.002962;
 b[15] = -0.002889;
 b[16] = -0.002794;
 b[17] = 0.006055;
 b[18] = 0.00233;
 b[19] = -0.0043;
 b[20] = 0.003764;
 b[21] = -0.005285;
 b[22] = -0.003697;
 b[23] = -0.003757;
 b[24] = -0.005131;
 b[25] = -0.006252;
 b[26] = -0.003981;
 b[27] = -0.002819;
#endif

 //resoudreLCP(dim, b, M, x);
 lcp_lexicolemke(dim, b, M, x);
 //nlcp_gaussseidel(dim, b, M, x, 0.1, 0, 500, false, true);

#if 1
  afficheLCP(b, M, x+dim, dim);

  std::cout << "Mf+q=[";
  for (int i=0; i<dim; i++){
    double v = b[i];
    for (int j=0; j<dim; j++){
      v += M[i][j]*x[j+dim];
    }
    printf("\t%.10f\n", v);
  }
  std::cout << "    ];" << std::endl;
#else
  std::cout << "Mf+b:";
  for (int i=0; i<dim; i++){
    double v = b[i];
    for (int j=0; j<dim; j++){
      v += M[i][j]*x[j];
    }
    std::cout << v << ",";
  }
  std::cout << std::endl;
#endif

  return 0;
}
